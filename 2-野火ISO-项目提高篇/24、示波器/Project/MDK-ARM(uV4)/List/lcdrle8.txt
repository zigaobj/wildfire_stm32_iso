; generated by ARM C/C++ Compiler, 5.03 [Build 76]
; commandline ArmCC [--list --split_sections --debug -c --asm --interleave -o.\obj\lcdrle8.o --asm_dir=.\List\ --list_dir=.\List\ --depend=.\obj\lcdrle8.d --cpu=Cortex-M3 --apcs=interwork -O0 -I..\..\Libraries\CMSIS\CM3\CoreSupport -I..\..\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x -I..\..\Libraries\STM32F10x_StdPeriph_Driver\inc -I..\..\uCOS-II\Source -I..\..\uCOS-II\Ports\ARM-Cortex-M3\Generic\RealView -I..\..\User\app -I..\..\User\bsp -I..\..\uCGUI\inc -I..\..\uCGUI\Config -I..\..\uCGUI\LCDDriver -I..\..\uCGUI\uCGUIDemo -I..\..\User\fatfs -I..\..\User\mp3\pub -I..\..\User\Memory -Id:\Keil\ARM\RV31\INC -Id:\Keil\ARM\CMSIS\Include -Id:\Keil\ARM\Inc\ST\STM32F10x -D__MICROLIB -DSTM32F10X_HD -DUSE_STDPERIPH_DRIVER --omf_browse=.\obj\lcdrle8.crf ..\..\uCGUI\Core\LCDRLE8.c]
                          THUMB

                          AREA ||i._DrawBitmap_RLE8||, CODE, READONLY, ALIGN=2

                  _DrawBitmap_RLE8 PROC
;;;47     */
;;;48     static void _DrawBitmap_RLE8(int x0,int y0,int xsize, int ysize, const U8 GUI_UNI_PTR * pPixel, const LCD_LOGPALETTE GUI_UNI_PTR * pLogPal, int xMag, int yMag) {
000000  e92d4fff          PUSH     {r0-r11,lr}
000004  b08b              SUB      sp,sp,#0x2c
000006  4680              MOV      r8,r0
000008  460e              MOV      r6,r1
00000a  4693              MOV      r11,r2
00000c  f8dd906c          LDR      r9,[sp,#0x6c]
000010  9f18              LDR      r7,[sp,#0x60]
;;;49       LCD_PIXELINDEX aColorIndex[2];
;;;50       LCD_PIXELINDEX PixelIndex;
;;;51       int xi,y;
;;;52       int xL, yL;
;;;53       const U8 GUI_UNI_PTR * pPixelOrg = pPixel;
000012  9706              STR      r7,[sp,#0x18]
;;;54       char NoTrans = !(GUI_Context.DrawMode & LCD_DRAWMODE_TRANS);
000014  4884              LDR      r0,|L1.552|
000016  7c00              LDRB     r0,[r0,#0x10]  ; GUI_Context
000018  2101              MOVS     r1,#1
00001a  ea210050          BIC      r0,r1,r0,LSR #1
00001e  9005              STR      r0,[sp,#0x14]
;;;55       const LCD_PIXELINDEX* pTrans =NULL;
000020  2000              MOVS     r0,#0
000022  9004              STR      r0,[sp,#0x10]
;;;56       char IsMagnified = ((yMag | xMag) != 1);
000024  981a              LDR      r0,[sp,#0x68]
000026  ea490000          ORR      r0,r9,r0
00002a  2801              CMP      r0,#1
00002c  d001              BEQ      |L1.50|
00002e  2001              MOVS     r0,#1
000030  e000              B        |L1.52|
                  |L1.50|
000032  2000              MOVS     r0,#0
                  |L1.52|
000034  9003              STR      r0,[sp,#0xc]
;;;57       aColorIndex[0] = LCD_ACOLORINDEX[0];
000036  487c              LDR      r0,|L1.552|
000038  8800              LDRH     r0,[r0,#0]  ; GUI_Context
00003a  f8ad0028          STRH     r0,[sp,#0x28]
;;;58       aColorIndex[1] = LCD_ACOLORINDEX[1];
00003e  487a              LDR      r0,|L1.552|
000040  8840              LDRH     r0,[r0,#2]  ; GUI_Context
000042  f8ad002a          STRH     r0,[sp,#0x2a]
;;;59       /* Handle color translation */
;;;60       if ((pLogPal) && (pLogPal->pPalEntries)) {
000046  9819              LDR      r0,[sp,#0x64]
000048  b150              CBZ      r0,|L1.96|
00004a  9819              LDR      r0,[sp,#0x64]
00004c  6880              LDR      r0,[r0,#8]
00004e  b138              CBZ      r0,|L1.96|
;;;61         if ((pTrans = LCD_GetpPalConvTable(pLogPal)) == NULL) {
000050  9819              LDR      r0,[sp,#0x64]
000052  f7fffffe          BL       LCD_GetpPalConvTable
000056  9004              STR      r0,[sp,#0x10]
000058  b910              CBNZ     r0,|L1.96|
                  |L1.90|
;;;62           return;
;;;63         }
;;;64       }
;;;65      /* Check if we can limit the number of lines due to clipping) */
;;;66       if (yMag == 1) {
;;;67         if (ysize > GUI_Context.ClipRect.y1 - y0 + 1)
;;;68           ysize = GUI_Context.ClipRect.y1 - y0 + 1;
;;;69       }
;;;70       /* Init variables for looping */
;;;71       xi=0;
;;;72       y =0;
;;;73       /* Check if we can use the cache to save some unnecessary iterations */
;;;74       if (!IsMagnified) {
;;;75         int yDiff = GUI_Context.ClipRect.y0 - y0;
;;;76         if ((Cache.pPixelStart == pPixel) && (yDiff > Cache.y)) {
;;;77           /* Accept cache values */
;;;78           y = Cache.y;
;;;79           xi = Cache.x;
;;;80           pPixel = Cache.pPixel;
;;;81         }
;;;82       }
;;;83       /* Init values for caching */
;;;84       Cache.pPixel = Cache.pPixelStart = pPixelOrg;
;;;85       Cache.x = Cache.y = 0;
;;;86       /* Repeat until we have reached bottom */
;;;87       for (; y < ysize; ) {
;;;88         U8 Cmd  = *pPixel++;
;;;89         U8 Data = *pPixel++;
;;;90         if (Cmd) {
;;;91           /* Save cache info */
;;;92           Cache.pPixel = pPixel-2;
;;;93           Cache.x = xi;
;;;94           Cache.y = y;
;;;95           LCD_ACOLORINDEX[1] = pTrans ? *(pTrans+Data) : Data;
;;;96           while (Cmd) {
;;;97             int xi1 = xi+Cmd;
;;;98             if (xi1>=xsize)
;;;99               xi1 = xsize;
;;;100            Cmd -= (xi1-xi);
;;;101            if (Data || NoTrans) {  /* Skip transparent pixels */
;;;102              if (IsMagnified) {
;;;103                xL = xMag * xi + x0;
;;;104                yL = yMag * y + y0;
;;;105                LCD_FillRect(xL, yL, xL + xMag * (xi1 - xi) -1 , yL + yMag - 1);
;;;106              } else {
;;;107                LCD_DrawHLine(x0+xi, y + y0, xi1+x0-1);
;;;108              }
;;;109            }
;;;110            xi =xi1;
;;;111            if (xi1==xsize) {
;;;112              y++;
;;;113              xi=0;
;;;114            }
;;;115          }
;;;116        } else {
;;;117          do {
;;;118            U8 Index = *pPixel++;
;;;119            if (Index || NoTrans) {  /* Skip transparent pixels */
;;;120              int x = x0+xi;
;;;121              PixelIndex = pTrans ? *(pTrans+Index) : Index;
;;;122              if (IsMagnified) {
;;;123                LCD_SetColorIndex(PixelIndex);
;;;124                xL = xMag * xi + x0;
;;;125                yL = yMag * y + y0;
;;;126                LCD_FillRect(xL, yL, xL + xMag -1 , yL + yMag - 1);
;;;127              } else {
;;;128                #if 1 /* High speed variant */
;;;129                  if (y + y0>= GUI_Context.ClipRect.y0)
;;;130                    if (x >= GUI_Context.ClipRect.x0)
;;;131                      if (x <= GUI_Context.ClipRect.x1)
;;;132                        LCDDEV_L0_SetPixelIndex(x, y + y0, PixelIndex);
;;;133                #else
;;;134                  LCD_SetPixelIndex(x, y + y0, PixelIndex);
;;;135                #endif
;;;136              }
;;;137            }
;;;138            if (++xi >= xsize) {
;;;139              xi=0; y++;
;;;140              if (y >= ysize)
;;;141                break;
;;;142            }
;;;143          } while (--Data);
;;;144        }
;;;145      }
;;;146      LCD_ACOLORINDEX[0] = aColorIndex[0];
;;;147      LCD_ACOLORINDEX[1] = aColorIndex[1];
;;;148    }
00005a  b00f              ADD      sp,sp,#0x3c
00005c  e8bd8ff0          POP      {r4-r11,pc}
                  |L1.96|
000060  f1b90f01          CMP      r9,#1                 ;66
000064  d10d              BNE      |L1.130|
000066  4870              LDR      r0,|L1.552|
000068  f9b0000e          LDRSH    r0,[r0,#0xe]          ;67
00006c  1b80              SUBS     r0,r0,r6              ;67
00006e  1c40              ADDS     r0,r0,#1              ;67
000070  990e              LDR      r1,[sp,#0x38]         ;67
000072  4288              CMP      r0,r1                 ;67
000074  da05              BGE      |L1.130|
000076  486c              LDR      r0,|L1.552|
000078  f9b0000e          LDRSH    r0,[r0,#0xe]          ;68
00007c  1b80              SUBS     r0,r0,r6              ;68
00007e  1c40              ADDS     r0,r0,#1              ;68
000080  900e              STR      r0,[sp,#0x38]         ;68
                  |L1.130|
000082  2400              MOVS     r4,#0                 ;71
000084  2500              MOVS     r5,#0                 ;72
000086  9803              LDR      r0,[sp,#0xc]          ;74
000088  b980              CBNZ     r0,|L1.172|
00008a  4967              LDR      r1,|L1.552|
00008c  f9b1100a          LDRSH    r1,[r1,#0xa]          ;75
000090  1b88              SUBS     r0,r1,r6              ;75
000092  4966              LDR      r1,|L1.556|
000094  68c9              LDR      r1,[r1,#0xc]          ;76  ; Cache
000096  42b9              CMP      r1,r7                 ;76
000098  d107              BNE      |L1.170|
00009a  4964              LDR      r1,|L1.556|
00009c  6849              LDR      r1,[r1,#4]            ;76  ; Cache
00009e  4281              CMP      r1,r0                 ;76
0000a0  da03              BGE      |L1.170|
0000a2  4962              LDR      r1,|L1.556|
0000a4  684d              LDR      r5,[r1,#4]            ;78  ; Cache
0000a6  680c              LDR      r4,[r1,#0]            ;79  ; Cache
0000a8  688f              LDR      r7,[r1,#8]            ;80  ; Cache
                  |L1.170|
0000aa  bf00              NOP                            ;82
                  |L1.172|
0000ac  495f              LDR      r1,|L1.556|
0000ae  9806              LDR      r0,[sp,#0x18]         ;84
0000b0  60c8              STR      r0,[r1,#0xc]          ;84  ; Cache
0000b2  6088              STR      r0,[r1,#8]            ;84  ; Cache
0000b4  2000              MOVS     r0,#0                 ;85
0000b6  6048              STR      r0,[r1,#4]            ;85  ; Cache
0000b8  6008              STR      r0,[r1,#0]            ;85  ; Cache
0000ba  e0a8              B        |L1.526|
                  |L1.188|
0000bc  f8170b01          LDRB     r0,[r7],#1            ;88
0000c0  9002              STR      r0,[sp,#8]            ;88
0000c2  f8170b01          LDRB     r0,[r7],#1            ;89
0000c6  9001              STR      r0,[sp,#4]            ;89
0000c8  9802              LDR      r0,[sp,#8]            ;90
0000ca  2800              CMP      r0,#0                 ;90
0000cc  d04a              BEQ      |L1.356|
0000ce  1eb8              SUBS     r0,r7,#2              ;92
0000d0  4956              LDR      r1,|L1.556|
0000d2  6088              STR      r0,[r1,#8]            ;92  ; Cache
0000d4  4608              MOV      r0,r1                 ;93
0000d6  6004              STR      r4,[r0,#0]            ;93  ; Cache
0000d8  6045              STR      r5,[r0,#4]            ;94  ; Cache
0000da  9804              LDR      r0,[sp,#0x10]         ;95
0000dc  b120              CBZ      r0,|L1.232|
0000de  9901              LDR      r1,[sp,#4]            ;95
0000e0  9804              LDR      r0,[sp,#0x10]         ;95
0000e2  f8300011          LDRH     r0,[r0,r1,LSL #1]     ;95
0000e6  e000              B        |L1.234|
                  |L1.232|
0000e8  9801              LDR      r0,[sp,#4]            ;95
                  |L1.234|
0000ea  494f              LDR      r1,|L1.552|
0000ec  8048              STRH     r0,[r1,#2]            ;95
0000ee  e035              B        |L1.348|
                  |L1.240|
0000f0  9802              LDR      r0,[sp,#8]            ;97
0000f2  eb040a00          ADD      r10,r4,r0             ;97
0000f6  45da              CMP      r10,r11               ;98
0000f8  db00              BLT      |L1.252|
0000fa  46da              MOV      r10,r11               ;99
                  |L1.252|
0000fc  ebaa0104          SUB      r1,r10,r4             ;100
000100  9802              LDR      r0,[sp,#8]            ;100
000102  1a40              SUBS     r0,r0,r1              ;100
000104  b2c0              UXTB     r0,r0                 ;100
000106  9002              STR      r0,[sp,#8]            ;100
000108  9801              LDR      r0,[sp,#4]            ;101
00010a  b908              CBNZ     r0,|L1.272|
00010c  9805              LDR      r0,[sp,#0x14]         ;101
00010e  b1f8              CBZ      r0,|L1.336|
                  |L1.272|
000110  9803              LDR      r0,[sp,#0xc]          ;102
000112  b1a8              CBZ      r0,|L1.320|
000114  981a              LDR      r0,[sp,#0x68]         ;103
000116  fb008004          MLA      r0,r0,r4,r8           ;103
00011a  9008              STR      r0,[sp,#0x20]         ;103
00011c  fb096005          MLA      r0,r9,r5,r6           ;104
000120  9007              STR      r0,[sp,#0x1c]         ;104
000122  9807              LDR      r0,[sp,#0x1c]         ;105
000124  4448              ADD      r0,r0,r9              ;105
000126  1e43              SUBS     r3,r0,#1              ;105
000128  ebaa0c04          SUB      r12,r10,r4            ;105
00012c  991a              LDR      r1,[sp,#0x68]         ;105
00012e  9808              LDR      r0,[sp,#0x20]         ;105
000130  fb01000c          MLA      r0,r1,r12,r0          ;105
000134  1e42              SUBS     r2,r0,#1              ;105
000136  e9dd1007          LDRD     r1,r0,[sp,#0x1c]      ;105
00013a  f7fffffe          BL       LCD_FillRect
00013e  e007              B        |L1.336|
                  |L1.320|
000140  eb0a0308          ADD      r3,r10,r8             ;107
000144  1e5a              SUBS     r2,r3,#1              ;107
000146  19a9              ADDS     r1,r5,r6              ;107
000148  eb080004          ADD      r0,r8,r4              ;107
00014c  f7fffffe          BL       LCD_DrawHLine
                  |L1.336|
000150  4654              MOV      r4,r10                ;110
000152  45da              CMP      r10,r11               ;111
000154  d101              BNE      |L1.346|
000156  1c6d              ADDS     r5,r5,#1              ;112
000158  2400              MOVS     r4,#0                 ;113
                  |L1.346|
00015a  bf00              NOP                            ;115
                  |L1.348|
00015c  9802              LDR      r0,[sp,#8]            ;96
00015e  2800              CMP      r0,#0                 ;96
000160  d1c6              BNE      |L1.240|
000162  e053              B        |L1.524|
                  |L1.356|
000164  bf00              NOP                            ;117
                  |L1.358|
000166  f8170b01          LDRB     r0,[r7],#1            ;118
00016a  9000              STR      r0,[sp,#0]            ;118
00016c  9800              LDR      r0,[sp,#0]            ;119
00016e  b908              CBNZ     r0,|L1.372|
000170  9805              LDR      r0,[sp,#0x14]         ;119
000172  b3d0              CBZ      r0,|L1.490|
                  |L1.372|
000174  eb080a04          ADD      r10,r8,r4             ;120
000178  9804              LDR      r0,[sp,#0x10]         ;121
00017a  b120              CBZ      r0,|L1.390|
00017c  9900              LDR      r1,[sp,#0]            ;121
00017e  9804              LDR      r0,[sp,#0x10]         ;121
000180  f8300011          LDRH     r0,[r0,r1,LSL #1]     ;121
000184  e000              B        |L1.392|
                  |L1.390|
000186  9800              LDR      r0,[sp,#0]            ;121
                  |L1.392|
000188  9009              STR      r0,[sp,#0x24]         ;121
00018a  9803              LDR      r0,[sp,#0xc]          ;122
00018c  b1a8              CBZ      r0,|L1.442|
00018e  9809              LDR      r0,[sp,#0x24]         ;123
000190  f7fffffe          BL       LCD_SetColorIndex
000194  981a              LDR      r0,[sp,#0x68]         ;124
000196  fb008004          MLA      r0,r0,r4,r8           ;124
00019a  9008              STR      r0,[sp,#0x20]         ;124
00019c  fb096005          MLA      r0,r9,r5,r6           ;125
0001a0  9007              STR      r0,[sp,#0x1c]         ;125
0001a2  9807              LDR      r0,[sp,#0x1c]         ;126
0001a4  4448              ADD      r0,r0,r9              ;126
0001a6  1e43              SUBS     r3,r0,#1              ;126
0001a8  991a              LDR      r1,[sp,#0x68]         ;126
0001aa  9808              LDR      r0,[sp,#0x20]         ;126
0001ac  4408              ADD      r0,r0,r1              ;126
0001ae  1e42              SUBS     r2,r0,#1              ;126
0001b0  e9dd1007          LDRD     r1,r0,[sp,#0x1c]      ;126
0001b4  f7fffffe          BL       LCD_FillRect
0001b8  e016              B        |L1.488|
                  |L1.442|
0001ba  19a9              ADDS     r1,r5,r6              ;129
0001bc  481a              LDR      r0,|L1.552|
0001be  f9b0000a          LDRSH    r0,[r0,#0xa]          ;129
0001c2  4281              CMP      r1,r0                 ;129
0001c4  db10              BLT      |L1.488|
0001c6  4818              LDR      r0,|L1.552|
0001c8  f9b00008          LDRSH    r0,[r0,#8]            ;130  ; GUI_Context
0001cc  4550              CMP      r0,r10                ;130
0001ce  dc0b              BGT      |L1.488|
0001d0  4815              LDR      r0,|L1.552|
0001d2  f9b0000c          LDRSH    r0,[r0,#0xc]          ;131
0001d6  4550              CMP      r0,r10                ;131
0001d8  db06              BLT      |L1.488|
0001da  19a9              ADDS     r1,r5,r6              ;132
0001dc  4812              LDR      r0,|L1.552|
0001de  6cc0              LDR      r0,[r0,#0x4c]         ;132  ; GUI_Context
0001e0  6a43              LDR      r3,[r0,#0x24]         ;132
0001e2  4650              MOV      r0,r10                ;132
0001e4  9a09              LDR      r2,[sp,#0x24]         ;132
0001e6  4798              BLX      r3                    ;132
                  |L1.488|
0001e8  bf00              NOP                            ;137
                  |L1.490|
0001ea  1c60              ADDS     r0,r4,#1              ;138
0001ec  4604              MOV      r4,r0                 ;138
0001ee  4558              CMP      r0,r11                ;138
0001f0  db05              BLT      |L1.510|
0001f2  2400              MOVS     r4,#0                 ;139
0001f4  1c6d              ADDS     r5,r5,#1              ;139
0001f6  980e              LDR      r0,[sp,#0x38]         ;140
0001f8  4285              CMP      r5,r0                 ;140
0001fa  db00              BLT      |L1.510|
0001fc  e005              B        |L1.522|
                  |L1.510|
0001fe  9801              LDR      r0,[sp,#4]            ;143
000200  1e40              SUBS     r0,r0,#1              ;143
000202  f01000ff          ANDS     r0,r0,#0xff           ;143
000206  9001              STR      r0,[sp,#4]            ;143
000208  d1ad              BNE      |L1.358|
                  |L1.522|
00020a  bf00              NOP                            ;141
                  |L1.524|
00020c  bf00              NOP                            ;145
                  |L1.526|
00020e  980e              LDR      r0,[sp,#0x38]         ;87
000210  4285              CMP      r5,r0                 ;87
000212  f6ffaf53          BLT      |L1.188|
000216  f8bd0028          LDRH     r0,[sp,#0x28]         ;146
00021a  4903              LDR      r1,|L1.552|
00021c  8008              STRH     r0,[r1,#0]            ;146
00021e  f8bd002a          LDRH     r0,[sp,#0x2a]         ;147
000222  8048              STRH     r0,[r1,#2]            ;147
000224  bf00              NOP      
000226  e718              B        |L1.90|
;;;149    
                          ENDP

                  |L1.552|
                          DCD      GUI_Context
                  |L1.556|
                          DCD      Cache

                          AREA ||.bss||, DATA, NOINIT, ALIGN=2

                  Cache
                          %        16

                          AREA ||.constdata||, DATA, READONLY, ALIGN=2

                  GUI_BitmapMethodsRLE8
                          DCD      _DrawBitmap_RLE8
                          DCD      0x00000000
